[package]
name = "webz-core"
version = "0.1.0"
authors = ["ChainSafe Systems"]
license = "MIT OR Apache-2.0"
repository = "https://github.com/ChainSafe/WebZjs"
description = "A browser client-side library for implementing Zcash wallets"
edition = "2021"

[lib]
crate-type = ["cdylib", "rlib"]

[profile.release]
# Tell `rustc` to optimize for small code size.
opt-level = 3
lto = true
codegen-units = 1

[package.metadata.wasm-pack.profile.release]
wasm-opt = ["-O4", "-O4"]

[dependencies]
wasm-bindgen = "0.2.84"
js-sys = "0.3.69"

getrandom = { version = "0.2", features = ["js"] }
thiserror = "1.0.63"
console_error_panic_hook = { version = "0.1.7", optional = true }
wasm-bindgen-futures = "0.4.42"

# Zcash specific dependencies
incrementalmerkletree = "0.5"
sapling = { package = "sapling-crypto", version = "0.1" }
orchard = "0.8.0"
zip32 = "0.1.1"
shardtree = "0.3"

zcash_keys = { git = "https://github.com/zcash/librustzcash", rev = "05887be9622fbc68ff901b05e04321627618d3bf", features = [ "transparent-inputs", "orchard", "sapling", "unstable"] }
zcash_primitives = { git = "https://github.com/zcash/librustzcash", rev = "05887be9622fbc68ff901b05e04321627618d3bf" }
zcash_client_backend = { git = "https://github.com/zcash/librustzcash", rev = "05887be9622fbc68ff901b05e04321627618d3bf" }
zcash_protocol = { git = "https://github.com/zcash/librustzcash", rev = "05887be9622fbc68ff901b05e04321627618d3bf" }
secrecy = "0.8.0"

[dev-dependencies]
wasm-bindgen-test = "0.3.42"

[build-dependencies]
tonic-build = { version = "0.12", default-features = false, features = [
    "prost",
] }
which = "4"

[patch."https://github.com/zcash/librustzcash"]
zcash_keys = { path = "../librustzcash/zcash_keys" }
zcash_primitives = { path = "../librustzcash/zcash_primitives" }
zcash_client_backend = { path = "../librustzcash/zcash_client_backend" }
zcash_protocol = {  path = "../librustzcash/components/zcash_protocol" }

[patch.crates-io]
incrementalmerkletree = { git = "https://github.com/zcash/incrementalmerkletree", rev = "337f59179eda51261e9ddfc6b18e8fb84ea277c9" }
shardtree = { git = "https://github.com/zcash/incrementalmerkletree", rev = "337f59179eda51261e9ddfc6b18e8fb84ea277c9" }
